================================================================================
    FILES NECESSITY ANALYSIS - Scripts and Utilities
================================================================================

Analysis of all .sh scripts and latency_tracker.py to determine what's
necessary vs optional for the Jack in the Box Voice Agent system.


================================================================================
.SH SCRIPTS ANALYSIS
================================================================================

1. refresh_qu_nightly.sh (3.2K)
   Purpose: Automate nightly menu refresh on EC2 (stops services, clears 
            Qdrant storage, restarts with fresh indexing)
   Used by: Cron job on EC2 (runs at 4:00 AM daily)
   Necessity: ‚úÖ NECESSARY (for production)
   Can remove: ‚ùå NO - Critical for keeping menu data fresh
   Local use: ‚ùå No (EC2-specific paths and setup)

2. restart-qu.sh (2.4K)
   Purpose: Manual restart of Qdrant and Rust backend with fresh indexing
   Used by: Manual execution when menu needs refresh
   Necessity: ‚úÖ NECESSARY (for manual refresh)
   Can remove: ‚ùå NO - Useful for troubleshooting and manual refreshes
   Local use: ‚úÖ Yes (can be used locally with minor path adjustments)

3. restart_all_services_ec2.sh (4.4K)
   Purpose: Restart all services on EC2 (Qdrant, Rust, Python) from your local
            machine via SSH
   Used by: Manual execution from local machine
   Necessity: ‚ö†Ô∏è  OPTIONAL (but very convenient)
   Can remove: ‚ö†Ô∏è  MAYBE - Convenient but can be done manually
   Local use: ‚ùå No (SSH to EC2 from local machine)
   
   Alternative: SSH to EC2 and run commands manually
   Recommendation: KEEP - Very useful for quick deployments

4. setup_nightly_refresh.sh (1.6K)
   Purpose: One-time setup to install the nightly refresh cron job on EC2
   Used by: One-time execution during initial setup
   Necessity: ‚ö†Ô∏è  OPTIONAL (one-time use)
   Can remove: ‚ö†Ô∏è  MAYBE - Only needed if you need to reinstall cron job
   Local use: ‚ùå No (deploys to EC2)
   
   Alternative: SSH to EC2 and set up cron job manually
   Recommendation: KEEP - Useful for re-deployment or new server setup


================================================================================
LATENCY_TRACKER.PY ANALYSIS
================================================================================

Purpose: Track performance metrics (function execution time, agent response 
         time, user speech duration)

Used by:
   ‚Ä¢ web_voice_agent_server.py (7 calls)
     - start_timer("deepgram_response")
     - end_timer("deepgram_response", ...)
     - start_timer("function_call_total")
     - etc.
   
   ‚Ä¢ jitb_functions.py (5 calls)
     - start_timer("qu_query_items")
     - end_timer("qu_query_items", ...)
     - start_timer("qu_query_modifiers")
     - etc.

Output: latency_logs.txt (174K, actively written to)

Sample log entry:
   2025-11-18 17:03:57.752 | LATENCY | deepgram_response | 12544.70ms | type=AgentAudioDone

Necessity: ‚ö†Ô∏è  OPTIONAL (useful for performance monitoring)
Can remove: ‚úÖ YES - Not critical for functionality
Impact if removed:
   - No latency metrics will be logged
   - No performance monitoring
   - System will still work perfectly

Recommendation: ‚ö†Ô∏è  KEEP FOR NOW
   Reasons:
   - Helps identify performance issues
   - Useful for debugging slow responses
   - Low overhead (just logging)
   - Can help optimize agent response time
   
   Can be removed if:
   - You don't need performance metrics
   - Log file grows too large
   - You want to minimize dependencies


================================================================================
LATENCY_LOGS.TXT ANALYSIS
================================================================================

File: latency_logs.txt
Size: 174K
Purpose: Stores all latency measurements
Last entry: Recent (actively being written to)

Necessity: ‚ö†Ô∏è  OPTIONAL (if latency_tracker.py is kept)
Can remove: ‚úÖ YES - Can delete to free space, will be recreated
Recommendation: Archive old logs periodically

Cleanup command:
   # Keep last 1000 lines
   tail -1000 latency_logs.txt > latency_logs.tmp && mv latency_logs.tmp latency_logs.txt
   
   # Or delete entirely (will be recreated)
   rm latency_logs.txt


================================================================================
RECOMMENDATIONS
================================================================================

‚úÖ KEEP ALL FILES (Recommended):
   Reasons:
   - All .sh scripts serve specific purposes
   - Latency tracking helps with performance monitoring
   - Small file sizes (~12K total for .sh files)
   - Useful for troubleshooting and deployment

‚ö†Ô∏è  MINIMAL SETUP (If you want to remove some):

   KEEP:
   1. refresh_qu_nightly.sh - Critical for production menu freshness
   2. restart-qu.sh - Useful for manual troubleshooting
   3. latency_tracker.py - Helpful for performance issues
   
   MOVE TO EXTRA:
   4. restart_all_services_ec2.sh - Convenient but not critical
   5. setup_nightly_refresh.sh - One-time use
   
   DELETE/ARCHIVE:
   6. latency_logs.txt - Can delete, will be recreated


================================================================================
IF YOU DECIDE TO REMOVE LATENCY TRACKING
================================================================================

Files to remove:
   ‚Ä¢ latency_tracker.py
   ‚Ä¢ latency_logs.txt

Code changes needed:
   1. web_voice_agent_server.py:
      - Remove: from latency_tracker import start_timer, end_timer
      - Remove: All start_timer() and end_timer() calls (7 locations)
   
   2. jitb_functions.py:
      - Remove: from latency_tracker import start_timer, end_timer
      - Remove: All start_timer() and end_timer() calls (5 locations)

Impact: None on functionality, just lose performance metrics


================================================================================
SUMMARY TABLE
================================================================================

File                          | Size  | Necessary? | Local Use | Recommendation
------------------------------|-------|------------|-----------|---------------
refresh_qu_nightly.sh         | 3.2K  | ‚úÖ YES     | ‚ùå NO     | KEEP
restart-qu.sh                 | 2.4K  | ‚úÖ YES     | ‚úÖ YES    | KEEP
restart_all_services_ec2.sh   | 4.4K  | ‚ö†Ô∏è  MAYBE  | ‚ùå NO     | KEEP (convenient)
setup_nightly_refresh.sh      | 1.6K  | ‚ö†Ô∏è  MAYBE  | ‚ùå NO     | KEEP (reusable)
latency_tracker.py            | ?     | ‚ö†Ô∏è  MAYBE  | ‚úÖ YES    | KEEP (useful)
latency_logs.txt              | 174K  | ‚ùå NO      | ‚úÖ YES    | Archive periodically


================================================================================
FINAL VERDICT
================================================================================

üéØ RECOMMENDATION: KEEP ALL FILES

Total size: ~195K (negligible)
Total scripts: 4 .sh files + 1 .py utility
Value: High (automation, monitoring, troubleshooting)

All files serve a purpose and take minimal space. The convenience and 
troubleshooting value far outweigh the minimal storage cost.

If storage is critical, only latency_logs.txt can be safely deleted/archived.


================================================================================
END OF ANALYSIS
================================================================================

